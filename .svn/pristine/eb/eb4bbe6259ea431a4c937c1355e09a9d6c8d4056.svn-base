(function(e){"use strict";function t(){var t=this;this.x=0;this.y=0;this.target=false;this.clone=false;this.placeholder=false;this.cloneoffset={x:0,y:0};this.move=function(e){t.x=e.pageX;t.y=e.pageY;if(t.clone!=false&&t.target!=false){t.clone.css({top:t.y-t.cloneoffset.y,left:t.x-t.cloneoffset.x})}else{}};e(window).on("mousemove",function(e){t.move(e)})}e.prototype.dad=function(a){var s,o,l;s=this;o={target:">div",draggable:false,callback:false,containerClass:"dad-container",childrenClass:"dads-children",cloneClass:"dads-children-clone",active:true};l=e.extend({},o,a);e(this).each(function(){var a,o,i,n,r,f,d,c,h,p;a=new t;n=l.active;d=e(this);if(!d.hasClass("dad-active")&&n==true)d.addClass("dad-active");c=l.childrenClass;p=l.cloneClass;h="."+c;d.addClass(l.containerClass);o=d.find(l.target);f=l.placeholder;r=l.callback;i="dad-draggable-area";s.addDropzone=function(t,s){e(t).on("mouseenter",function(){if(a.target!=false){a.placeholder.css({display:"none"});a.target.css({display:"none"});e(this).addClass("active")}}).on("mouseup",function(){if(a.target!=false){a.placeholder.css({display:"block"});a.target.css({display:"block"});s(a.target);g()}e(this).removeClass("active")}).on("mouseleave",function(){if(a.target!=false){a.placeholder.css({display:"block"});a.target.css({display:"block"})}e(this).removeClass("active")})};s.getPosition=function(){var t=[];e(this).find(h).each(function(){t[e(this).attr("data-dad-id")]=parseInt(e(this).attr("data-dad-position"))});return t};s.activate=function(){n=true;if(!d.hasClass("dad-active")){d.addClass("dad-active")}return s};s.deactivate=function(){n=false;d.removeClass("dad-active");return s};e(document).on("mouseup",function(){g()});var v=1;o.addClass(c).each(function(){if(e(this).data("dad-id")==undefined){e(this).attr("data-dad-id",v)}e(this).attr("data-dad-position",v);v++});function u(t){var a=1;t.find(h).each(function(){e(this).attr("data-dad-position",a);a++})}function g(){if(a.target!=false&&a.clone!=false){if(r!=false){r(a.target)}var t=a.target;var s=a.clone;var o=a.placeholder;var l=0;Math.floor(parseFloat(d.css("border-left-width")));var i=0;Math.floor(parseFloat(d.css("border-top-width")));if(e.contains(d[0],a.target[0])){a.clone.animate({top:a.target.offset().top-d.offset().top-i,left:a.target.offset().left-d.offset().left-l},300,function(){t.css({visibility:"visible"}).removeClass("active");s.remove()})}else{a.clone.fadeOut(300,function(){s.remove()})}o.remove();a.clone=false;a.placeholder=false;a.target=false;u(d)}e("html,body").removeClass("dad-noSelect")}function m(t){if(a.target!=false&&a.clone!=false){var s,o;o=e('<span style="display:none"></span>');s=e('<span style="display:none"></span>');if(t.prevAll().hasClass("active")){t.after(s)}else{t.before(s)}a.target.before(o);s.before(a.target);a.placeholder.css({top:a.target.offset().top-d.offset().top,left:a.target.offset().left-d.offset().left,width:a.target.outerWidth()-10,height:a.target.outerHeight()-10});o.remove();s.remove()}}var y=l.draggable!=false?l.draggable:h;d.find(y).addClass(i);d.find(y).on("mousedown touchstart",function(t){if(a.target==false&&t.which==1&&n==true){if(l.draggable!=false){a.target=d.find(h).has(this)}else{a.target=e(this)}a.clone=a.target.clone();a.target.css({visibility:"hidden"}).addClass("active");a.clone.addClass(p);d.append(a.clone);a.placeholder=e("<div></div>");d.append(a.placeholder);var s,o;var i=Math.floor(parseFloat(d.css("border-left-width")));var r=Math.floor(parseFloat(d.css("border-top-width")));s=a.x-a.target.offset().left+d.offset().left+i;o=a.y-a.target.offset().top+d.offset().top+r;a.cloneoffset.x=s;a.cloneoffset.y=o;a.clone.removeClass(c).css({position:"absolute",top:a.y-a.cloneoffset.y,left:a.x-a.cloneoffset.x});e("html,body").addClass("dad-noSelect")}});e(h).on("mouseenter",function(){m(e(this))})});return this}})(jQuery);