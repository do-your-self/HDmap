if(typeof JSON!=="object"){JSON={}}(function(){"use strict";function f(e){return e<10?"0"+e:e}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(e){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(e){return this.valueOf()}}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(e){escapable.lastIndex=0;return escapable.test(e)?'"'+e.replace(escapable,function(e){var t=meta[e];return typeof t==="string"?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var a,r,n,o,i=gap,s,u=t[e];if(u&&typeof u==="object"&&typeof u.toJSON==="function"){u=u.toJSON(e)}if(typeof rep==="function"){u=rep.call(t,e,u)}switch(typeof u){case"string":return quote(u);case"number":return isFinite(u)?String(u):"null";case"boolean":case"null":return String(u);case"object":if(!u){return"null"}gap+=indent;s=[];if(Object.prototype.toString.apply(u)==="[object Array]"){o=u.length;for(a=0;a<o;a+=1){s[a]=str(a,u)||"null"}n=s.length===0?"[]":gap?"[\n"+gap+s.join(",\n"+gap)+"\n"+i+"]":"["+s.join(",")+"]";gap=i;return n}if(rep&&typeof rep==="object"){o=rep.length;for(a=0;a<o;a+=1){if(typeof rep[a]==="string"){r=rep[a];n=str(r,u);if(n){s.push(quote(r)+(gap?": ":":")+n)}}}}else{for(r in u){if(Object.prototype.hasOwnProperty.call(u,r)){n=str(r,u);if(n){s.push(quote(r)+(gap?": ":":")+n)}}}}n=s.length===0?"{}":gap?"{\n"+gap+s.join(",\n"+gap)+"\n"+i+"}":"{"+s.join(",")+"}";gap=i;return n}}if(typeof JSON.stringify!=="function"){JSON.stringify=function(e,t,a){var r;gap="";indent="";if(typeof a==="number"){for(r=0;r<a;r+=1){indent+=" "}}else if(typeof a==="string"){indent=a}rep=t;if(t&&typeof t!=="function"&&(typeof t!=="object"||typeof t.length!=="number")){throw new Error("JSON.stringify")}return str("",{"":e})}}if(typeof JSON.parse!=="function"){JSON.parse=function(text,reviver){var j;function walk(e,t){var a,r,n=e[t];if(n&&typeof n==="object"){for(a in n){if(Object.prototype.hasOwnProperty.call(n,a)){r=walk(n,a);if(r!==undefined){n[a]=r}else{delete n[a]}}}}return reviver.call(e,t,n)}text=String(text);cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})}if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof reviver==="function"?walk({"":j},""):j}throw new SyntaxError("JSON.parse")}}})();(function(e,t){"use strict";var a=e.History=e.History||{},r=e.jQuery;if(typeof a.Adapter!=="undefined"){throw new Error("History.js Adapter has already been loaded...")}a.Adapter={bind:function(e,t,a){r(e).bind(t,a)},trigger:function(e,t,a){r(e).trigger(t,a)},extractEventData:function(e,a,r){var n=a&&a.originalEvent&&a.originalEvent[e]||r&&r[e]||t;return n},onDomLoad:function(e){r(e)}};if(typeof a.init!=="undefined"){a.init()}})(window);(function(e,t){"use strict";var a=e.document,r=e.setTimeout||r,n=e.clearTimeout||n,o=e.setInterval||o,i=e.History=e.History||{};if(typeof i.initHtml4!=="undefined"){throw new Error("History.js HTML4 Support has already been loaded...")}i.initHtml4=function(){if(typeof i.initHtml4.initialized!=="undefined"){return false}else{i.initHtml4.initialized=true}i.enabled=true;i.savedHashes=[];i.isLastHash=function(e){var t=i.getHashByIndex(),a;a=e===t;return a};i.isHashEqual=function(e,t){e=encodeURIComponent(e).replace(/%25/g,"%");t=encodeURIComponent(t).replace(/%25/g,"%");return e===t};i.saveHash=function(e){if(i.isLastHash(e)){return false}i.savedHashes.push(e);return true};i.getHashByIndex=function(e){var t=null;if(typeof e==="undefined"){t=i.savedHashes[i.savedHashes.length-1]}else if(e<0){t=i.savedHashes[i.savedHashes.length+e]}else{t=i.savedHashes[e]}return t};i.discardedHashes={};i.discardedStates={};i.discardState=function(e,t,a){var r=i.getHashByState(e),n;n={discardedState:e,backState:a,forwardState:t};i.discardedStates[r]=n;return true};i.discardHash=function(e,t,a){var r={discardedHash:e,backState:a,forwardState:t};i.discardedHashes[e]=r;return true};i.discardedState=function(e){var t=i.getHashByState(e),a;a=i.discardedStates[t]||false;return a};i.discardedHash=function(e){var t=i.discardedHashes[e]||false;return t};i.recycleState=function(e){var t=i.getHashByState(e);if(i.discardedState(e)){delete i.discardedStates[t]}return true};if(i.emulated.hashChange){i.hashChangeInit=function(){i.checkerFunction=null;var t="",r,n,s,u,l=Boolean(i.getHash());if(i.isInternetExplorer()){r="historyjs-iframe";n=a.createElement("iframe");n.setAttribute("id",r);n.setAttribute("src","#");n.style.display="none";a.body.appendChild(n);n.contentWindow.document.open();n.contentWindow.document.close();s="";u=false;i.checkerFunction=function(){if(u){return false}u=true;var a=i.getHash(),r=i.getHash(n.contentWindow.document);if(a!==t){t=a;if(r!==a){s=r=a;n.contentWindow.document.open();n.contentWindow.document.close();n.contentWindow.document.location.hash=i.escapeHash(a)}i.Adapter.trigger(e,"hashchange")}else if(r!==s){s=r;if(l&&r===""){i.back()}else{i.setHash(r,false)}}u=false;return true}}else{i.checkerFunction=function(){var a=i.getHash()||"";if(a!==t){t=a;i.Adapter.trigger(e,"hashchange")}return true}}i.intervalList.push(o(i.checkerFunction,i.options.hashChangeInterval));return true};i.Adapter.onDomLoad(i.hashChangeInit)}if(i.emulated.pushState){i.onHashChange=function(t){var a=t&&t.newURL||i.getLocationHref(),r=i.getHashByUrl(a),n=null,o=null,s=null,u;if(i.isLastHash(r)){i.busy(false);return false}i.doubleCheckComplete();i.saveHash(r);if(r&&i.isTraditionalAnchor(r)){i.Adapter.trigger(e,"anchorchange");i.busy(false);return false}n=i.extractState(i.getFullUrl(r||i.getLocationHref()),true);if(i.isLastSavedState(n)){i.busy(false);return false}o=i.getHashByState(n);u=i.discardedState(n);if(u){if(i.getHashByIndex(-2)===i.getHashByState(u.forwardState)){i.back(false)}else{i.forward(false)}return false}i.pushState(n.data,n.title,encodeURI(n.url),false);return true};i.Adapter.bind(e,"hashchange",i.onHashChange);i.pushState=function(t,a,r,n){r=encodeURI(r).replace(/%25/g,"%");if(i.getHashByUrl(r)){throw new Error("History.js does not support states with fragment-identifiers (hashes/anchors).")}if(n!==false&&i.busy()){i.pushQueue({scope:i,callback:i.pushState,args:arguments,queue:n});return false}i.busy(true);var o=i.createStateObject(t,a,r),s=i.getHashByState(o),u=i.getState(false),l=i.getHashByState(u),f=i.getHash(),c=i.expectedStateId==o.id;i.storeState(o);i.expectedStateId=o.id;i.recycleState(o);i.setTitle(o);if(s===l){i.busy(false);return false}i.saveState(o);if(!c)i.Adapter.trigger(e,"statechange");if(!i.isHashEqual(s,f)&&!i.isHashEqual(s,i.getShortUrl(i.getLocationHref()))){i.setHash(s,false)}i.busy(false);return true};i.replaceState=function(t,a,r,n){r=encodeURI(r).replace(/%25/g,"%");if(i.getHashByUrl(r)){throw new Error("History.js does not support states with fragment-identifiers (hashes/anchors).")}if(n!==false&&i.busy()){i.pushQueue({scope:i,callback:i.replaceState,args:arguments,queue:n});return false}i.busy(true);var o=i.createStateObject(t,a,r),s=i.getHashByState(o),u=i.getState(false),l=i.getHashByState(u),f=i.getStateByIndex(-2);i.discardState(u,o,f);if(s===l){i.storeState(o);i.expectedStateId=o.id;i.recycleState(o);i.setTitle(o);i.saveState(o);i.Adapter.trigger(e,"statechange");i.busy(false)}else{i.pushState(o.data,o.title,o.url,false)}return true}}if(i.emulated.pushState){if(i.getHash()&&!i.emulated.hashChange){i.Adapter.onDomLoad(function(){i.Adapter.trigger(e,"hashchange")})}}};if(typeof i.init!=="undefined"){i.init()}})(window);(function(e,t){"use strict";var a=e.console||t,r=e.document,n=e.navigator,o=false,i=e.setTimeout,s=e.clearTimeout,u=e.setInterval,l=e.clearInterval,f=e.JSON,c=e.alert,d=e.History=e.History||{},p=e.history;try{o=e.sessionStorage;o.setItem("TEST","1");o.removeItem("TEST")}catch(e){o=false}f.stringify=f.stringify||f.encode;f.parse=f.parse||f.decode;if(typeof d.init!=="undefined"){throw new Error("History.js Core has already been loaded...")}d.init=function(e){if(typeof d.Adapter==="undefined"){return false}if(typeof d.initCore!=="undefined"){d.initCore()}if(typeof d.initHtml4!=="undefined"){d.initHtml4()}return true};d.initCore=function(h){if(typeof d.initCore.initialized!=="undefined"){return false}else{d.initCore.initialized=true}d.options=d.options||{};d.options.hashChangeInterval=d.options.hashChangeInterval||100;d.options.safariPollInterval=d.options.safariPollInterval||500;d.options.doubleCheckInterval=d.options.doubleCheckInterval||500;d.options.disableSuid=d.options.disableSuid||false;d.options.storeInterval=d.options.storeInterval||1e3;d.options.busyDelay=d.options.busyDelay||250;d.options.debug=d.options.debug||false;d.options.initialTitle=d.options.initialTitle||r.title;d.options.html4Mode=d.options.html4Mode||false;d.options.delayInit=d.options.delayInit||false;d.intervalList=[];d.clearAllIntervals=function(){var e,t=d.intervalList;if(typeof t!=="undefined"&&t!==null){for(e=0;e<t.length;e++){l(t[e])}d.intervalList=null}};d.debug=function(){if(d.options.debug||false){d.log.apply(d,arguments)}};d.log=function(){var e=!(typeof a==="undefined"||typeof a.log==="undefined"||typeof a.log.apply==="undefined"),t=r.getElementById("log"),n,o,i,s,u;if(e){s=Array.prototype.slice.call(arguments);n=s.shift();if(typeof a.debug!=="undefined"){a.debug.apply(a,[n,s])}else{a.log.apply(a,[n,s])}}else{n="\n"+arguments[0]+"\n"}for(o=1,i=arguments.length;o<i;++o){u=arguments[o];if(typeof u==="object"&&typeof f!=="undefined"){try{u=f.stringify(u)}catch(e){}}n+="\n"+u+"\n"}if(t){t.value+=n+"\n-----\n";t.scrollTop=t.scrollHeight-t.clientHeight}else if(!e){c(n)}return true};d.getInternetExplorerMajorVersion=function(){var e=d.getInternetExplorerMajorVersion.cached=typeof d.getInternetExplorerMajorVersion.cached!=="undefined"?d.getInternetExplorerMajorVersion.cached:function(){var e=3,t=r.createElement("div"),a=t.getElementsByTagName("i");while((t.innerHTML="\x3c!--[if gt IE "+ ++e+"]><i></i><![endif]--\x3e")&&a[0]){}return e>4?e:false}();return e};d.isInternetExplorer=function(){var e=d.isInternetExplorer.cached=typeof d.isInternetExplorer.cached!=="undefined"?d.isInternetExplorer.cached:Boolean(d.getInternetExplorerMajorVersion());return e};if(d.options.html4Mode){d.emulated={pushState:true,hashChange:true}}else{d.emulated={pushState:!Boolean(e.history&&e.history.pushState&&e.history.replaceState&&!(/ Mobile\/([1-7][a-z]|(8([abcde]|f(1[0-8]))))/i.test(n.userAgent)||/AppleWebKit\/5([0-2]|3[0-2])/i.test(n.userAgent))),hashChange:Boolean(!("onhashchange"in e||"onhashchange"in r)||d.isInternetExplorer()&&d.getInternetExplorerMajorVersion()<8)}}d.enabled=!d.emulated.pushState;d.bugs={setHash:Boolean(!d.emulated.pushState&&n.vendor==="Apple Computer, Inc."&&/AppleWebKit\/5([0-2]|3[0-3])/.test(n.userAgent)),safariPoll:Boolean(!d.emulated.pushState&&n.vendor==="Apple Computer, Inc."&&/AppleWebKit\/5([0-2]|3[0-3])/.test(n.userAgent)),ieDoubleCheck:Boolean(d.isInternetExplorer()&&d.getInternetExplorerMajorVersion()<8),hashEscape:Boolean(d.isInternetExplorer()&&d.getInternetExplorerMajorVersion()<7)};d.isEmptyObject=function(e){for(var t in e){if(e.hasOwnProperty(t)){return false}}return true};d.cloneObject=function(e){var t,a;if(e){t=f.stringify(e);a=f.parse(t)}else{a={}}return a};d.getRootUrl=function(){var e=r.location.protocol+"//"+(r.location.hostname||r.location.host);if(r.location.port||false){e+=":"+r.location.port}e+="/";return e};d.getBaseHref=function(){var e=r.getElementsByTagName("base"),t=null,a="";if(e.length===1){t=e[0];a=t.href.replace(/[^\/]+$/,"")}a=a.replace(/\/+$/,"");if(a)a+="/";return a};d.getBaseUrl=function(){var e=d.getBaseHref()||d.getBasePageUrl()||d.getRootUrl();return e};d.getPageUrl=function(){var e=d.getState(false,false),t=(e||{}).url||d.getLocationHref(),a;a=t.replace(/\/+$/,"").replace(/[^\/]+$/,function(e,t,a){return/\./.test(e)?e:e+"/"});return a};d.getBasePageUrl=function(){var e=d.getLocationHref().replace(/[#\?].*/,"").replace(/[^\/]+$/,function(e,t,a){return/[^\/]$/.test(e)?"":e}).replace(/\/+$/,"")+"/";return e};d.getFullUrl=function(e,t){var a=e,r=e.substring(0,1);t=typeof t==="undefined"?true:t;if(/[a-z]+\:\/\//.test(e)){}else if(r==="/"){a=d.getRootUrl()+e.replace(/^\/+/,"")}else if(r==="#"){a=d.getPageUrl().replace(/#.*/,"")+e}else if(r==="?"){a=d.getPageUrl().replace(/[\?#].*/,"")+e}else{if(t){a=d.getBaseUrl()+e.replace(/^(\.\/)+/,"")}else{a=d.getBasePageUrl()+e.replace(/^(\.\/)+/,"")}}return a.replace(/\#$/,"")};d.getShortUrl=function(e){var t=e,a=d.getBaseUrl(),r=d.getRootUrl();if(d.emulated.pushState){t=t.replace(a,"")}t=t.replace(r,"/");if(d.isTraditionalAnchor(t)){t="./"+t}t=t.replace(/^(\.\/)+/g,"./").replace(/\#$/,"");return t};d.getLocationHref=function(e){e=e||r;if(e.URL===e.location.href)return e.location.href;if(e.location.href===decodeURIComponent(e.URL))return e.URL;if(e.location.hash&&decodeURIComponent(e.location.href.replace(/^[^#]+/,""))===e.location.hash)return e.location.href;if(e.URL.indexOf("#")==-1&&e.location.href.indexOf("#")!=-1)return e.location.href;return e.URL||e.location.href};d.store={};d.idToState=d.idToState||{};d.stateToId=d.stateToId||{};d.urlToId=d.urlToId||{};d.storedStates=d.storedStates||[];d.savedStates=d.savedStates||[];d.normalizeStore=function(){d.store.idToState=d.store.idToState||{};d.store.urlToId=d.store.urlToId||{};d.store.stateToId=d.store.stateToId||{}};d.getState=function(e,t){if(typeof e==="undefined"){e=true}if(typeof t==="undefined"){t=true}var a=d.getLastSavedState();if(!a&&t){a=d.createStateObject()}if(e){a=d.cloneObject(a);a.url=a.cleanUrl||a.url}return a};d.getIdByState=function(e){var t=d.extractId(e.url),a;if(!t){a=d.getStateString(e);if(typeof d.stateToId[a]!=="undefined"){t=d.stateToId[a]}else if(typeof d.store.stateToId[a]!=="undefined"){t=d.store.stateToId[a]}else{while(true){t=(new Date).getTime()+String(Math.random()).replace(/\D/g,"");if(typeof d.idToState[t]==="undefined"&&typeof d.store.idToState[t]==="undefined"){break}}d.stateToId[a]=t;d.idToState[t]=e}}return t};d.normalizeState=function(e){var t,a;if(!e||typeof e!=="object"){e={}}if(typeof e.normalized!=="undefined"){return e}if(!e.data||typeof e.data!=="object"){e.data={}}t={};t.normalized=true;t.title=e.title||"";t.url=d.getFullUrl(e.url?e.url:d.getLocationHref());t.hash=d.getShortUrl(t.url);t.data=d.cloneObject(e.data);t.id=d.getIdByState(t);t.cleanUrl=t.url.replace(/\??\&_suid.*/,"");t.url=t.cleanUrl;a=!d.isEmptyObject(t.data);if((t.title||a)&&d.options.disableSuid!==true){t.hash=d.getShortUrl(t.url).replace(/\??\&_suid.*/,"");if(!/\?/.test(t.hash)){t.hash+="?"}t.hash+="&_suid="+t.id}t.hashedUrl=d.getFullUrl(t.hash);if((d.emulated.pushState||d.bugs.safariPoll)&&d.hasUrlDuplicate(t)){t.url=t.hashedUrl}return t};d.createStateObject=function(e,t,a){var r={data:e,title:t,url:a};r=d.normalizeState(r);return r};d.getStateById=function(e){e=String(e);var a=d.idToState[e]||d.store.idToState[e]||t;return a};d.getStateString=function(e){var t,a,r;t=d.normalizeState(e);a={data:t.data,title:e.title,url:e.url};r=f.stringify(a);return r};d.getStateId=function(e){var t,a;t=d.normalizeState(e);a=t.id;return a};d.getHashByState=function(e){var t,a;t=d.normalizeState(e);a=t.hash;return a};d.extractId=function(e){var t,a,r,n;if(e.indexOf("#")!=-1){n=e.split("#")[0]}else{n=e}a=/(.*)\&_suid=([0-9]+)$/.exec(n);r=a?a[1]||e:e;t=a?String(a[2]||""):"";return t||false};d.isTraditionalAnchor=function(e){var t=!/[\/\?\.]/.test(e);return t};d.extractState=function(e,t){var a=null,r,n;t=t||false;r=d.extractId(e);if(r){a=d.getStateById(r)}if(!a){n=d.getFullUrl(e);r=d.getIdByUrl(n)||false;if(r){a=d.getStateById(r)}if(!a&&t&&!d.isTraditionalAnchor(e)){a=d.createStateObject(null,null,n)}}return a};d.getIdByUrl=function(e){var a=d.urlToId[e]||d.store.urlToId[e]||t;return a};d.getLastSavedState=function(){return d.savedStates[d.savedStates.length-1]||t};d.getLastStoredState=function(){return d.storedStates[d.storedStates.length-1]||t};d.hasUrlDuplicate=function(e){var t=false,a;a=d.extractState(e.url);t=a&&a.id!==e.id;return t};d.storeState=function(e){d.urlToId[e.url]=e.id;d.storedStates.push(d.cloneObject(e));return e};d.isLastSavedState=function(e){var t=false,a,r,n;if(d.savedStates.length){a=e.id;r=d.getLastSavedState();n=r.id;t=a===n}return t};d.saveState=function(e){if(d.isLastSavedState(e)){return false}d.savedStates.push(d.cloneObject(e));return true};d.getStateByIndex=function(e){var t=null;if(typeof e==="undefined"){t=d.savedStates[d.savedStates.length-1]}else if(e<0){t=d.savedStates[d.savedStates.length+e]}else{t=d.savedStates[e]}return t};d.getCurrentIndex=function(){var e=null;if(d.savedStates.length<1){e=0}else{e=d.savedStates.length-1}return e};d.getHash=function(e){var t=d.getLocationHref(e),a;a=d.getHashByUrl(t);return a};d.unescapeHash=function(e){var t=d.normalizeHash(e);t=decodeURIComponent(t);return t};d.normalizeHash=function(e){var t=e.replace(/[^#]*#/,"").replace(/#.*/,"");return t};d.setHash=function(e,t){var a,n;if(t!==false&&d.busy()){d.pushQueue({scope:d,callback:d.setHash,args:arguments,queue:t});return false}d.busy(true);a=d.extractState(e,true);if(a&&!d.emulated.pushState){d.pushState(a.data,a.title,a.url,false)}else if(d.getHash()!==e){if(d.bugs.setHash){n=d.getPageUrl();d.pushState(null,null,n+"#"+e,false)}else{r.location.hash=e}}return d};d.escapeHash=function(t){var a=d.normalizeHash(t);a=e.encodeURIComponent(a);if(!d.bugs.hashEscape){a=a.replace(/\%21/g,"!").replace(/\%26/g,"&").replace(/\%3D/g,"=").replace(/\%3F/g,"?")}return a};d.getHashByUrl=function(e){var t=String(e).replace(/([^#]*)#?([^#]*)#?(.*)/,"$2");t=d.unescapeHash(t);return t};d.setTitle=function(e){var t=e.title,a;if(!t){a=d.getStateByIndex(0);if(a&&a.url===e.url){t=a.title||d.options.initialTitle}}try{r.getElementsByTagName("title")[0].innerHTML=t.replace("<","&lt;").replace(">","&gt;").replace(" & "," &amp; ")}catch(e){}r.title=t;return d};d.queues=[];d.busy=function(e){if(typeof e!=="undefined"){d.busy.flag=e}else if(typeof d.busy.flag==="undefined"){d.busy.flag=false}if(!d.busy.flag){s(d.busy.timeout);var t=function(){var e,a,r;if(d.busy.flag)return;for(e=d.queues.length-1;e>=0;--e){a=d.queues[e];if(a.length===0)continue;r=a.shift();d.fireQueueItem(r);d.busy.timeout=i(t,d.options.busyDelay)}};d.busy.timeout=i(t,d.options.busyDelay)}return d.busy.flag};d.busy.flag=false;d.fireQueueItem=function(e){return e.callback.apply(e.scope||d,e.args||[])};d.pushQueue=function(e){d.queues[e.queue||0]=d.queues[e.queue||0]||[];d.queues[e.queue||0].push(e);return d};d.queue=function(e,t){if(typeof e==="function"){e={callback:e}}if(typeof t!=="undefined"){e.queue=t}if(d.busy()){d.pushQueue(e)}else{d.fireQueueItem(e)}return d};d.clearQueue=function(){d.busy.flag=false;d.queues=[];return d};d.stateChanged=false;d.doubleChecker=false;d.doubleCheckComplete=function(){d.stateChanged=true;d.doubleCheckClear();return d};d.doubleCheckClear=function(){if(d.doubleChecker){s(d.doubleChecker);d.doubleChecker=false}return d};d.doubleCheck=function(e){d.stateChanged=false;d.doubleCheckClear();if(d.bugs.ieDoubleCheck){d.doubleChecker=i(function(){d.doubleCheckClear();if(!d.stateChanged){e()}return true},d.options.doubleCheckInterval)}return d};d.safariStatePoll=function(){var t=d.extractState(d.getLocationHref()),a;if(!d.isLastSavedState(t)){a=t}else{return}if(!a){a=d.createStateObject()}d.Adapter.trigger(e,"popstate");return d};d.back=function(e){if(e!==false&&d.busy()){d.pushQueue({scope:d,callback:d.back,args:arguments,queue:e});return false}d.busy(true);d.doubleCheck(function(){d.back(false)});p.go(-1);return true};d.forward=function(e){if(e!==false&&d.busy()){d.pushQueue({scope:d,callback:d.forward,args:arguments,queue:e});return false}d.busy(true);d.doubleCheck(function(){d.forward(false)});p.go(1);return true};d.go=function(e,t){var a;if(e>0){for(a=1;a<=e;++a){d.forward(t)}}else if(e<0){for(a=-1;a>=e;--a){d.back(t)}}else{throw new Error("History.go: History.go requires a positive or negative integer passed.")}return d};if(d.emulated.pushState){var g=function(){};d.pushState=d.pushState||g;d.replaceState=d.replaceState||g}else{d.onPopState=function(t,a){var r=false,n=false,o,i;d.doubleCheckComplete();o=d.getHash();if(o){i=d.extractState(o||d.getLocationHref(),true);if(i){d.replaceState(i.data,i.title,i.url,false)}else{d.Adapter.trigger(e,"anchorchange");d.busy(false)}d.expectedStateId=false;return false}r=d.Adapter.extractEventData("state",t,a)||false;if(r){n=d.getStateById(r)}else if(d.expectedStateId){n=d.getStateById(d.expectedStateId)}else{n=d.extractState(d.getLocationHref())}if(!n){n=d.createStateObject(null,null,d.getLocationHref())}d.expectedStateId=false;if(d.isLastSavedState(n)){d.busy(false);return false}d.storeState(n);d.saveState(n);d.setTitle(n);d.Adapter.trigger(e,"statechange");d.busy(false);return true};d.Adapter.bind(e,"popstate",d.onPopState);d.pushState=function(t,a,r,n){if(d.getHashByUrl(r)&&d.emulated.pushState){throw new Error("History.js does not support states with fragement-identifiers (hashes/anchors).")}if(n!==false&&d.busy()){d.pushQueue({scope:d,callback:d.pushState,args:arguments,queue:n});return false}d.busy(true);var o=d.createStateObject(t,a,r);if(d.isLastSavedState(o)){d.busy(false)}else{d.storeState(o);d.expectedStateId=o.id;p.pushState(o.id,o.title,o.url);d.Adapter.trigger(e,"popstate")}return true};d.replaceState=function(t,a,r,n){if(d.getHashByUrl(r)&&d.emulated.pushState){throw new Error("History.js does not support states with fragement-identifiers (hashes/anchors).")}if(n!==false&&d.busy()){d.pushQueue({scope:d,callback:d.replaceState,args:arguments,queue:n});return false}d.busy(true);var o=d.createStateObject(t,a,r);if(d.isLastSavedState(o)){d.busy(false)}else{d.storeState(o);d.expectedStateId=o.id;p.replaceState(o.id,o.title,o.url);d.Adapter.trigger(e,"popstate")}return true}}if(o){try{d.store=f.parse(o.getItem("History.store"))||{}}catch(e){d.store={}}d.normalizeStore()}else{d.store={};d.normalizeStore()}d.Adapter.bind(e,"unload",d.clearAllIntervals);d.saveState(d.storeState(d.extractState(d.getLocationHref(),true)));if(o){d.onUnload=function(){var e,t,a;try{e=f.parse(o.getItem("History.store"))||{}}catch(t){e={}}e.idToState=e.idToState||{};e.urlToId=e.urlToId||{};e.stateToId=e.stateToId||{};for(t in d.idToState){if(!d.idToState.hasOwnProperty(t)){continue}e.idToState[t]=d.idToState[t]}for(t in d.urlToId){if(!d.urlToId.hasOwnProperty(t)){continue}e.urlToId[t]=d.urlToId[t]}for(t in d.stateToId){if(!d.stateToId.hasOwnProperty(t)){continue}e.stateToId[t]=d.stateToId[t]}d.store=e;d.normalizeStore();a=f.stringify(e);try{o.setItem("History.store",a)}catch(e){if(e.code===DOMException.QUOTA_EXCEEDED_ERR){if(o.length){o.removeItem("History.store");o.setItem("History.store",a)}else{}}else{throw e}}};d.intervalList.push(u(d.onUnload,d.options.storeInterval));d.Adapter.bind(e,"beforeunload",d.onUnload);d.Adapter.bind(e,"unload",d.onUnload)}if(!d.emulated.pushState){if(d.bugs.safariPoll){d.intervalList.push(u(d.safariStatePoll,d.options.safariPollInterval))}if(n.vendor==="Apple Computer, Inc."||(n.appCodeName||"")==="Mozilla"){d.Adapter.bind(e,"hashchange",function(){d.Adapter.trigger(e,"popstate")});if(d.getHash()){d.Adapter.onDomLoad(function(){d.Adapter.trigger(e,"hashchange")})}}}};if(!d.options||!d.options.delayInit){d.init()}})(window);